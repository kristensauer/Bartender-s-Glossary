---
import TwoColumns from "@components/TwoColumns.astro"
---

<h2 id="cocktails">Cocktails</h2>

<div class="cocktails-horizontal-scroll-container">
  <div class="cocktails-horizontal-scroll">
    <div class="content-box">
      <div class="content-details">
        <div class="content-info">
          <h3>Margarita</h3>
          <ul>
            <li>3 oz Tequila</li>
            <li>1.5 oz Triple Sec</li>
            <li>1.5 oz Sour Mix</li>
          </ul>
          <div class="steps-box">
            <ol>
              <li>Grab a pint glass and pour the ingredients in</li>
              <li>Add ice and shake</li>
              <li>Grab a margarita glass, rim as needed</li>
              <li>Pour cocktail into the glass and garnish with a lime wheel</li>
            </ol>
          </div>
        </div>
        <div class="content-image">
          <img src=/images/margarita.jpg alt="Margarita">
        </div>
      </div>
    </div>
    <div class="content-box">
      <div class="content-details">
        <div class="content-info">
          <h3>Paloma</h3>
          <ul>
            <li>3 oz Agave Tequila</li>
            <li>1.5 oz Lime Juice</li>
            <li>1.5 oz Agave</li>
            <li>0.5 oz Grapefruit Juice</li>
            <li>Club Soda</li>
          </ul>
          <div class="steps-box">
            <ol>
              <li>Grab a pint glass and pour ingredients</li>
              <li>Add ice and shake</li>
              <li>Grab a Collins glass and pour cocktail</li>
              <li>Top off with club soda and a lime wedge</li>
            </ol>
          </div>
        </div>
        <div class="content-image">
          <img src=/images/paloma.jpg alt="Paloma">
        </div>
      </div>
    </div>
    <div class="content-box">
      <div class="content-details">
        <div class="content-info">
          <h3>Sangria</h3>
          <ul>
          <li>1.5 oz Red or White Wine</li>
          <li>1.5 oz Sour Mix</li>
          <li>1.5 oz Brandy</li>
          <li>1 Tbsp Sugar</li>
          <li>Chopped Apple and Oranges</li>
          <li>Club Soda</li>
          </ul>
          <div class="steps-box">
            <ol>
              <li>Grab a pint glass and grab 2 tong-fulls of chopped apples and oranges, and other ingredients</li>
              <li>Add ice and shake</li>
              <li>Grab a wine glass and pour cocktail</li>
              <li>Top off with club soda</li>
            </ol>
          </div>
        </div>
        <div class="content-image">
          <img src=/images/sangria.jpg alt="Sangria">
        </div>
      </div>
    </div>
    <div class="content-box">
      <div class="content-details">
        <div class="content-info">
          <h3>Coconut Martini</h3>
          <ul>
            <li>1.5 oz Coconut Rum</li>
            <li>1.5 oz Vanilla Vodka</li>
            <li>0.5 oz Coconut Puree</li>
            <li>0.25 oz Pineapple Juice</li>
            <li>Coconut Flakes</li>
          </ul>
          <div class="steps-box">
            <ol>
              <li>Grab a pint glass and pour ingredients</li>
              <li>Add ice and shake</li>
              <li>Grab a chilled martini glass and strain cocktail</li>
              <li>Garnish with coconut flakes</li>
            </ol>
          </div>
        </div>
        <div class="content-image">
          <img src=/images/cocomartini.jpg alt="Coconut Martini">
        </div>
      </div>
    </div>
    <div class="content-box">
      <div class="content-details">
        <div class="content-info">
          <h3>Mudslide</h3>
          <ul>
            <li>1.5 oz Kahlua</li>
            <li>1.5 oz Irish Cream</li>
            <li>1.5 oz Vanilla Vodka</li>
            <li>0.5 oz Heavy Cream</li>
            <li>Chocolate Syrup</li>
          </ul>
          <div class="steps-box">
            <ol>
              <li>Grab a blender and add all ingredients</li>
              <li>Add ice and blend</li>
              <li>Grab a Collins glass and decorate with chocolate syrup</li>
              <li>Pour blended cocktail into glass</li>
            </ol>
          </div>
        </div>
        <div class="content-image">
          <img src=/images/mudslide.jpg alt="Mudslide">
        </div>
      </div>
    </div>
    <div class="content-box">
      <div class="content-details">
        <div class="content-info">
          <h3>Bloody Mary</h3>
          <ul>
            <li>3 oz Bloody Mary Mix</li>
            <li>1.5 oz Vodka</li>
            <li>1.5 oz Lemon Juice</li>
            <li>Celery</li>
            <li>Olives</li>
            <li>Lemon Wedge</li>
            <li>Lime Wedge</li>
          </ul>
          <div class="steps-box">
            <ol>
              <li>Grab a pint glass and add ice</li>
              <li>Pour ingredients in pint glass</li>
              <li>Garnish with celery, olives, lemon, and lime</li>
            </ol>
          </div>
        </div>
        <div class="content-image">
           <img src=/images/bloodymary.jpg alt="Bloody Mary">
        </div>
      </div>
    </div>
    <div class="content-box">
      <div class="content-details">
        <div class="content-info">
          <h3>Old Fashioned</h3>
          <ul>
            <li>1.5 oz Bourbon Whiskey</li>
            <li>1 Sugar Cube</li>
            <li>1 Cherry</li>
            <li>Orange Peel</li>
            <li>Bitters</li>
          </ul>
          <div class="steps-box">
            <ol>
              <li>Grab a rocks glass and muddle orange peel, cherry, and sugar cube</li>
              <li>Pour bourbon in glass</li>
              <li>Add 2-3 dashes of bitters</li>
              <li>Add ice and stir</li>
            </ol>
          </div>
        </div>
        <div class="content-image">
         <img src=/images/oldfashioned.jpg alt="Old Fashioned">
        </div>
      </div>
  </div>
</div>
  <div class="cocktails-scroll-controls" role="group" aria-label="Scroll cocktails">
    <button id="cocktailsLeftBtn" type="button" class="cocktails-scroll-btn" aria-label="Scroll left">‹</button>
    <button id="cocktailsRightBtn" type="button" class="cocktails-scroll-btn" aria-label="Scroll right">›</button>
  </div>
  
<style>

.cocktails-horizontal-scroll .content-info,
.shots-horizontal-scroll .content-info {
  display: grid;
  grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
  gap: 1rem 1.5rem;
  align-items: baseline;
  position: relative;
}

.cocktails-horizontal-scroll .content-info {
  margin-top: 0;
  padding-top: 1.5rem;
}

.cocktails-horizontal-scroll .content-info::after,
.shots-horizontal-scroll .content-info::after {
  content: "";
  position: absolute;
  top: 4.4rem;
  bottom: 10%;
  left: 48%;
  width: 2px;
  background: var(--color-text);
  transform: translateX(-50%);
  pointer-events: none;
}

.cocktails-horizontal-scroll .content-info > h3,
.shots-horizontal-scroll .content-info > h3 {
  grid-column: 1 / -1;
  border-bottom: 2px solid var(--color-text);
  margin: 0rem;
  padding-bottom: 0.5rem;
}

.cocktails-horizontal-scroll .content-info > ul,
.shots-horizontal-scroll .content-info > ul {
  grid-column: 1;
  margin: 0;
  padding-left: 1.1rem;
}

.cocktails-horizontal-scroll .content-info > ul {
  padding-right: 1rem;
}

.cocktails-horizontal-scroll .content-info > .steps-box ol {
  padding-left: 1.5rem;
}

.cocktails-horizontal-scroll .content-info > .steps-box,
.shots-horizontal-scroll .content-info > .steps-box {
  grid-column: 2;
}

@media (max-width: 900px) {
  .cocktails-horizontal-scroll .content-info,
  .shots-horizontal-scroll .content-info {
    grid-template-columns: 1fr;
  }

  .cocktails-horizontal-scroll .content-info::after,
  .shots-horizontal-scroll .content-info::after {
    display: none;
  }

  .cocktails-horizontal-scroll .content-info > .steps-box,
  .shots-horizontal-scroll .content-info > .steps-box {
    grid-column: 1;
  }
}
    .cocktails-horizontal-scroll-container {
      width: 60%;
      max-width: 60vw;
      overflow-x: auto;
      overflow-y: visible;
      padding: 1rem 0;
      display: flex;
      justify-content: center;
      margin-left: auto;
      margin-right: 0;
    }
    .cocktails-horizontal-scroll {
      display: flex;
      flex-direction: row;
      gap: 3rem;
      width: max-content;
      align-items: stretch;
      scroll-snap-type: x mandatory;
      overflow-x: auto;
      padding: 7rem 0 2rem;
      background: transparent;
    }
    .cocktails-horizontal-scroll .content-box {
      min-width: 300px;
      max-width: 360px;
      padding: 2.5rem 0.75rem 0.75rem 1rem;
      min-height: 620px;
      max-height: 760px;
    }
    .cocktails-horizontal-scroll .content-image img {
      filter: blur(20px) brightness(0.85);
    }
    .cocktails-horizontal-scroll .content-image::after {
      background: none;
      backdrop-filter: none;
    }
  .cocktails-scroll-controls {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-top: 3rem;
    position: relative;
    z-index: 1200;
    pointer-events: auto !important;
    width: 60%;
    max-width: 60vw;
    margin-left: auto;
    margin-right: 0;
  }
  .cocktails-scroll-btn {
    background: var(--color-background);
    color: var(--color-secondary);
    border: none;
    padding: 0.8rem 1.4rem;
    font-size: 2.6rem;
    line-height: 1;
    border-radius: 10px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    transition: transform 120ms ease, box-shadow 120ms ease, opacity 120ms ease;
    pointer-events: auto;
    touch-action: manipulation;
  }
  .cocktails-scroll-btn:active { 
    transform: translateY(1px); 
    box-shadow: 0 2px 6px rgba(0,0,0,0.08); }

  .cocktails-scroll-btn[disabled] { 
    opacity: 0.45; 
    cursor: default; 
    transform: none; 
    box-shadow: none; }

    h2#cocktails {
    font-family: var(--font-heading);
    font-weight: bold;
    color: var(--color-text);
    font-size: 8rem;
    text-align: left;
    margin-top: 30;
    margin-bottom: 30;
    position: absolute;
    left: 0;
    top: 110vh;
    transform: rotate(-90deg);
    transform-origin: left top;
    white-space: nowrap;
    z-index: 20;
  }
  </style>

  <script type="module">
    (function(){
      const viewport = document.querySelector('.cocktails-horizontal-scroll-container');
      if (!viewport) return;
      const track = viewport.querySelector('.cocktails-horizontal-scroll');
      const leftBtn = document.getElementById('cocktailsLeftBtn');
      const rightBtn = document.getElementById('cocktailsRightBtn');
      if (!track || !leftBtn || !rightBtn) return;

      try { console.debug('cocktails:init', { viewportClientW: viewport.clientWidth, viewportScrollW: viewport.scrollWidth }); } catch(e){}

      function getScrollAmount(){
        const item = track.querySelector('.content-box');
        if (!item) return Math.max(viewport.clientWidth, 300);
        const itemWidth = item.getBoundingClientRect().width;
        const style = getComputedStyle(track);
        const gapStr = style.gap || style.columnGap || '0px';
        const gap = parseFloat(gapStr) || 0;
        return Math.round(itemWidth + gap);
      }

      function updateButtons(){
        const maxScroll = Math.max(0, viewport.scrollWidth - viewport.clientWidth);
        const threshold = 6;
        const hasScroll = maxScroll > threshold;
        try { console.debug('cocktails:updateButtons', { maxScroll, scrollLeft: viewport.scrollLeft, hasScroll }); } catch(e){}
        leftBtn.disabled = hasScroll ? (viewport.scrollLeft <= threshold) : false;
        rightBtn.disabled = hasScroll ? (viewport.scrollLeft >= (maxScroll - threshold)) : false;
      }

      function doScroll(delta){
        const items = Array.from(track.querySelectorAll('.content-box'));
        if (items.length){
          const viewportRect = viewport.getBoundingClientRect();
          const viewportCenter = viewportRect.left + viewportRect.width / 2;
          let closestIdx = 0;
          let closestDist = Infinity;
          items.forEach((it, i) => {
            const r = it.getBoundingClientRect();
            const center = r.left + r.width / 2;
            const dist = Math.abs(center - viewportCenter);
            if (dist < closestDist) { closestDist = dist; closestIdx = i; }
          });
          const targetIdx = Math.max(0, Math.min(items.length - 1, closestIdx + delta));
          try { console.debug('cocktails: scroll to index', { closestIdx, targetIdx }); } catch(e){}
          try {
            items[targetIdx].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            return;
          } catch (e) {
            try { console.debug('cocktails: scrollIntoView failed, falling back', e); } catch(e){}
          }
        }

        const amt = getScrollAmount();
        const scrollTarget = delta * amt;
        try { console.debug('cocktails: fallback scroll by', scrollTarget); } catch(e){}
        if (typeof viewport.scrollBy === 'function') {
          viewport.scrollBy({ left: scrollTarget, behavior: 'smooth' });
        } else {
          viewport.scrollLeft = Math.max(0, Math.min(viewport.scrollWidth - viewport.clientWidth, viewport.scrollLeft + scrollTarget));
        }
      }

      leftBtn.addEventListener('click', function leftHandler(e){
        try { console.debug('cocktails:left click', e.target); } catch(e){}
        const r = leftBtn.getBoundingClientRect();
        try { console.debug('elementFromPoint at left center', document.elementFromPoint(r.left + r.width/2, r.top + r.height/2)); } catch(e){}
        doScroll(-1);
      }, { capture: true });
      rightBtn.addEventListener('click', function rightHandler(e){
        try { console.debug('cocktails:right click', e.target); } catch(e){}
        const r = rightBtn.getBoundingClientRect();
        try { console.debug('elementFromPoint at right center', document.elementFromPoint(r.left + r.width/2, r.top + r.height/2)); } catch(e){}
        doScroll(1);
      }, { capture: true });

      leftBtn.addEventListener('pointerdown', ()=> doScroll(-1), { passive: true });
      rightBtn.addEventListener('pointerdown', ()=> doScroll(1), { passive: true });

      document.addEventListener('click', function delegated(e){
        const target = e.target;
        if (!target) return;
        if (target.id === 'cocktailsLeftBtn') { doScroll(-1); }
        if (target.id === 'cocktailsRightBtn') { doScroll(1); }
      });

      viewport.addEventListener('scroll', updateButtons, { passive: true });
      window.addEventListener('resize', updateButtons);
      setTimeout(updateButtons, 150);
    })();
  </script>
  
